'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol ? "symbol" : typeof obj; };

var _path = require('path');

var _thenReadJson = require('then-read-json');

var _thenReadJson2 = _interopRequireDefault(_thenReadJson);

var _thenFs = require('then-fs');

var _thenFs2 = _interopRequireDefault(_thenFs);

var _sortObject = require('sort-object');

var _sortObject2 = _interopRequireDefault(_sortObject);

var _ = require('./');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var shouldSort = function shouldSort(key, value) {
  return (key === 'dependencies' || key === 'devDependencies') && (typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object';
};

var replacer = function replacer(key, value) {
  return shouldSort(key, value) ? (0, _sortObject2.default)(value) : value;
};

exports.default = function (inputArgs) {
  var fileName = (0, _path.join)(process.cwd(), 'package.json');
  (0, _thenReadJson2.default)(fileName).then(function (packageJson) {
    return (0, _.args)(packageJson, inputArgs);
  }).then(function (newPackageJson) {
    var string = JSON.stringify(newPackageJson, replacer, 2);

    return _thenFs2.default.writeFile(fileName, string);
  }).catch(function (err) {
    throw err;
  });
};